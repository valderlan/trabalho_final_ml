2025-12-02 22:44:57,829 - INFO - === Iniciando Treinamento com Grid Search ===
2025-12-02 22:44:57,998 - INFO - 
>> Processando: LogisticRegression
2025-12-02 22:44:57,998 - INFO - Iniciando Grid Search para LogisticRegression...
2025-12-02 22:56:05,422 - INFO - Melhores parâmetros LogisticRegression: {'C': 10}
2025-12-02 22:56:05,709 - INFO - Métricas Detalhadas para LogisticRegression: {"Model": "LogisticRegression", "Dataset": "Test", "Accuracy": 0.9797, "F1_Macro": 0.9797, "Recall": 0.9797, "Precision": 0.9798, "MCC": 0.9779, "Log_Loss": 0.0881, "Overfitting_Gap": -0.0004}
2025-12-02 22:56:06,006 - INFO - Modelo salvo em ONNX: models/LogisticRegression.onnx
2025-12-02 22:56:06,006 - INFO - 
>> Processando: KNN
2025-12-02 22:56:06,006 - INFO - Iniciando Grid Search para KNN...
2025-12-02 22:58:11,158 - INFO - Melhores parâmetros KNN: {'n_neighbors': 5, 'weights': 'distance'}
2025-12-02 22:59:16,038 - INFO - Métricas Detalhadas para KNN: {"Model": "KNN", "Dataset": "Test", "Accuracy": 0.9904, "F1_Macro": 0.9904, "Recall": 0.9904, "Precision": 0.9904, "MCC": 0.9895, "Log_Loss": 0.1522, "Overfitting_Gap": 0.0096}
2025-12-02 22:59:17,333 - INFO - Modelo salvo em ONNX: models/KNN.onnx
2025-12-02 22:59:17,335 - INFO - 
>> Processando: DecisionTree
2025-12-02 22:59:17,335 - INFO - Iniciando Grid Search para DecisionTree...
2025-12-02 23:00:20,309 - INFO - Melhores parâmetros DecisionTree: {'max_depth': 20, 'min_samples_split': 2}
2025-12-02 23:00:20,446 - INFO - Métricas Detalhadas para DecisionTree: {"Model": "DecisionTree", "Dataset": "Test", "Accuracy": 0.9991, "F1_Macro": 0.9991, "Recall": 0.9991, "Precision": 0.9991, "MCC": 0.999, "Log_Loss": 0.0221, "Overfitting_Gap": 0.0008}
2025-12-02 23:00:20,745 - INFO - Gráfico de Feature Importance salvo para DecisionTree
2025-12-02 23:00:20,752 - INFO - Modelo salvo em ONNX: models/DecisionTree.onnx
2025-12-02 23:00:20,752 - INFO - 
>> Processando: RandomForest
2025-12-02 23:00:20,752 - INFO - Iniciando Grid Search para RandomForest...
2025-12-02 23:10:53,840 - INFO - Melhores parâmetros RandomForest: {'criterion': 'entropy', 'max_depth': None, 'n_estimators': 100}
2025-12-02 23:10:56,433 - INFO - Métricas Detalhadas para RandomForest: {"Model": "RandomForest", "Dataset": "Test", "Accuracy": 0.9992, "F1_Macro": 0.9992, "Recall": 0.9992, "Precision": 0.9992, "MCC": 0.9992, "Log_Loss": 0.0098, "Overfitting_Gap": 0.0008}
2025-12-02 23:10:56,721 - INFO - Gráfico de Feature Importance salvo para RandomForest
2025-12-02 23:10:58,171 - INFO - Modelo salvo em ONNX: models/RandomForest.onnx
2025-12-02 23:10:58,184 - INFO - 
>> Processando: ExtraTrees
2025-12-02 23:10:58,184 - INFO - Iniciando Grid Search para ExtraTrees...
2025-12-02 23:18:18,354 - INFO - Melhores parâmetros ExtraTrees: {'criterion': 'gini', 'min_samples_split': 2, 'n_estimators': 200}
2025-12-02 23:18:26,170 - INFO - Métricas Detalhadas para ExtraTrees: {"Model": "ExtraTrees", "Dataset": "Test", "Accuracy": 0.996, "F1_Macro": 0.996, "Recall": 0.996, "Precision": 0.9961, "MCC": 0.9956, "Log_Loss": 0.0206, "Overfitting_Gap": 0.004}
2025-12-02 23:18:26,484 - INFO - Gráfico de Feature Importance salvo para ExtraTrees
2025-12-02 23:18:43,644 - INFO - Modelo salvo em ONNX: models/ExtraTrees.onnx
2025-12-02 23:18:43,693 - INFO - 
>> Processando: MLP_Sklearn
2025-12-02 23:18:43,693 - INFO - Iniciando Grid Search para MLP_Sklearn...
2025-12-02 23:32:56,735 - INFO - Melhores parâmetros MLP_Sklearn: {'alpha': 0.0001, 'hidden_layer_sizes': (64, 32)}
2025-12-02 23:32:57,003 - INFO - Métricas Detalhadas para MLP_Sklearn: {"Model": "MLP_Sklearn", "Dataset": "Test", "Accuracy": 0.9962, "F1_Macro": 0.9962, "Recall": 0.9962, "Precision": 0.9962, "MCC": 0.9959, "Log_Loss": 0.0177, "Overfitting_Gap": 0.0027}
2025-12-02 23:32:57,200 - INFO - Modelo salvo em ONNX: models/MLP_Sklearn.onnx
2025-12-02 23:32:57,200 - INFO - 
>> Processando: CNN_PyTorch
2025-12-02 23:32:57,200 - INFO - Treinando CNN_PyTorch (sem Grid Search)...
2025-12-02 23:34:12,078 - INFO - Métricas Detalhadas para CNN_PyTorch: {"Model": "CNN_PyTorch", "Dataset": "Test", "Accuracy": 0.9925, "F1_Macro": 0.9926, "Recall": 0.9925, "Precision": 0.9926, "MCC": 0.9919, "Log_Loss": 0.0267, "Overfitting_Gap": 0.0012}
2025-12-02 23:34:13,798 - WARNING - The model version conversion is not supported by the onnxscript version converter and fallback is enabled. The model will be converted using the onnx C API (target version: 11).
2025-12-02 23:34:13,804 - WARNING - Failed to convert the model to the target version 11 using the ONNX C API. The model was not modified
Traceback (most recent call last):
  File "/home/valderlan/Larces/trabalho_final_ml/.venv/lib/python3.13/site-packages/onnxscript/version_converter/__init__.py", line 127, in call
    converted_proto = _c_api_utils.call_onnx_api(
        func=_partial_convert_version, model=model
    )
  File "/home/valderlan/Larces/trabalho_final_ml/.venv/lib/python3.13/site-packages/onnxscript/version_converter/_c_api_utils.py", line 65, in call_onnx_api
    result = func(proto)
  File "/home/valderlan/Larces/trabalho_final_ml/.venv/lib/python3.13/site-packages/onnxscript/version_converter/__init__.py", line 122, in _partial_convert_version
    return onnx.version_converter.convert_version(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        proto, target_version=self.target_version
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/valderlan/Larces/trabalho_final_ml/.venv/lib/python3.13/site-packages/onnx/version_converter.py", line 39, in convert_version
    converted_model_str = C.convert_version(model_str, target_version)
RuntimeError: /github/workspace/onnx/version_converter/BaseConverter.h:68: adapter_lookup: Assertion `false` failed: No Adapter From Version $15 for Shape
2025-12-02 23:34:13,805 - INFO - No unused functions to remove
2025-12-02 23:34:13,805 - INFO - Skipping constant folding for node 'node_Shape_0' because it is graph input to preserve graph signature
2025-12-02 23:34:13,806 - INFO - Skipping constant folding for node 'node_unsqueeze' because it is graph input to preserve graph signature
2025-12-02 23:34:13,810 - INFO - Removed 3 unused nodes
2025-12-02 23:34:13,810 - INFO - No unused functions to remove
2025-12-02 23:34:13,810 - INFO - Skipping constant folding for node 'node_Shape_0' because it is graph input to preserve graph signature
2025-12-02 23:34:13,810 - INFO - Skipping constant folding for node 'node_unsqueeze' because it is graph input to preserve graph signature
2025-12-02 23:34:13,813 - INFO - Removed 1 unused nodes
2025-12-02 23:34:13,813 - INFO - No unused functions to remove
2025-12-02 23:34:13,815 - INFO - Modelo salvo em ONNX: models/CNN_PyTorch.onnx
2025-12-02 23:34:13,815 - INFO - Relatório JSON salvo em: json/training_metrics.json
2025-12-02 23:34:13,819 - INFO - Tabela Markdown salva em: relatorio_comparativo.md
2025-12-02 23:34:13,826 - INFO - Melhor modelo copiado para: models/best_model.onnx
